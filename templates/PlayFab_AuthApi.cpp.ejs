#include "stdafx.h"
#include <playfab/PlayFab<%- api.name %>AuthApi.h>
#include "<%- api.name %>AuthApi.h"
#include "ApiAsyncProviders.h"
#include "GlobalState.h"

using namespace PlayFab;
using namespace PlayFab::<%- api.name %>Models;
<% var authApiMemberName = api.name.charAt(0).toLowerCase() + api.name.slice(1) + "AuthAPI";
for (var i = 0; i < categorizedApi.loginCalls.length; i++) {
    var call = categorizedApi.loginCalls[i]; %>
HRESULT PlayFab<%- api.name %><%- call.name %>Async(
    _In_ PlayFabStateHandle stateHandle,
    _In_ const PlayFab<%- api.name %><%- call.request %>* request,
    _In_ XAsyncBlock* async
) noexcept
{
    RETURN_HR_INVALIDARG_IF_NULL(stateHandle);
    RETURN_HR_INVALIDARG_IF_NULL(request);

    auto provider = MakeAuthProvider(async, __FUNCTION__, std::bind(&<%- api.name %>AuthAPI::<%- call.name %>, &stateHandle->state-><%- authApiMemberName %>, *request, std::placeholders::_1));
    return Provider::Run(UniquePtr<Provider>(provider.release()));
}
<%
// Explicitly add PlayFabLoginWithXUserAsync implementation alongside LoginWithXbox
if (api.name === "Client" && call.name === "LoginWithXbox") { %>
#if HC_PLATFORM == HC_PLATFORM_GDK
HRESULT PlayFabClientLoginWithXUserAsync(
    _In_ PlayFabStateHandle stateHandle,
    _In_ const PlayFabClientLoginWithXUserRequest* request,
    _Inout_ XAsyncBlock* async
) noexcept
{
    RETURN_HR_INVALIDARG_IF_NULL(stateHandle);
    RETURN_HR_INVALIDARG_IF_NULL(request);

    auto provider = MakeAuthProvider(async, __FUNCTION__, std::bind(&ClientAuthAPI::LoginWithXUser, &stateHandle->state->clientAuthAPI, *request, std::placeholders::_1));
    return Provider::Run(UniquePtr<Provider>(provider.release()));
}
#endif
<% } // end if
} // end for %>
